<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>关于我 - 李弘政的主页</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous" />
        <link href="../styles.css" rel="stylesheet" />
    </head>

    <body>
        <nav
            class="navbar navbar-expand-lg navbar-light"
            style="
                background-color: skyblue;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            ">
            <div class="container-fluid">
                <a class="navbar-brand fw-bold" href="/">李弘政的主页</a>
                <button
                    class="navbar-toggler"
                    type="button"
                    data-bs-toggle="collapse"
                    data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto" id="dynamic-menu">
                        <!-- Menu items will be dynamically inserted here -->
                    </ul>
                </div>
            </div>
        </nav>

        <section class="container mt-5">
            <h1 class="mb-4"><strong>我的作品</strong></h1>
            <div id="projects-container"></div>
        </section>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                fetch("my-work.json")
                    .then((response) => response.json())
                    .then((data) => {
                        const container =
                            document.getElementById("projects-container");
                        data.projects.forEach((project) => {
                            const projectHTML = `
                            <div class="row align-items-start project mb-4">
                                <div class="col-md-8">
                                    <h2><em>${project.title}</em></h2>
                                    <div class="mb-3">
                                        ${project.technologies
                                            .map(
                                                (tech) => `
                                            <span class="badge bg-secondary me-1">${tech}</span>
                                        `,
                                            )
                                            .join("")}
                                    </div>
                                    <ul>
                                        ${project.description
                                            .map((item) => `<li>${item}</li>`)
                                            .join("")}
                                    </ul>
                                    ${project.links
                                        .map(
                                            (link) => `
                                        <a href="${link.url}" class="btn btn-outline-primary">${link.text}</a>
                                    `,
                                        )
                                        .join("")}
                                </div>
                                <div class="col-md-4">
                                    <img src="../${project.image}" alt="${
                                project.title
                            }" class="img-fluid">
                                </div>
                            </div>
                        `;
                            container.insertAdjacentHTML(
                                "beforeend",
                                projectHTML,
                            );
                        });
                    })
                    .catch((error) =>
                        console.error("Error loading projects:", error),
                    );
            });
        </script>

        <footer class="bg-light text-dark py-3 position-sticky mt-auto">
            <p class="text-center">
                感谢您访问我的网站。<br />
                如有任何问题或建议，请随时<a
                    href="mailto:hongzheng@cs.wisc.edu"
                    class="text-decoration-none text-primary fw-bold"
                    >联系我</a
                >。
            </p>
        </footer>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Menu Script -->
        <script>
            // Modified generateMenu function for Chinese version
            function generateMenu() {
                fetch("menus.json")
                    .then((response) => response.json())
                    .then((data) => {
                        const menuContainer =
                            document.getElementById("dynamic-menu");
                        data.menuItems.forEach((item) => {
                            const li = document.createElement("li");
                            li.className = "nav-item";

                            if (item.type === "dropdown") {
                                li.classList.add("dropdown");
                                const a = document.createElement("a");
                                a.className = "nav-link dropdown-toggle";
                                a.href = "#";
                                a.id = "navbarDropdown";
                                a.role = "button";
                                a.setAttribute("data-bs-toggle", "dropdown");
                                a.setAttribute("aria-expanded", "false");
                                a.textContent = item.text;

                                const ul = document.createElement("ul");
                                ul.className = "dropdown-menu";
                                ul.setAttribute(
                                    "aria-labelledby",
                                    "navbarDropdown",
                                );

                                item.items.forEach((subItem) => {
                                    const subLi = document.createElement("li");
                                    const subA = document.createElement("a");
                                    subA.className = "dropdown-item";
                                    subA.href = subItem.href;
                                    subA.textContent = subItem.text;
                                    subLi.appendChild(subA);
                                    ul.appendChild(subLi);
                                });

                                li.appendChild(a);
                                li.appendChild(ul);
                            } else if (item.type === "link") {
                                const a = document.createElement("a");
                                a.className = "nav-link";
                                a.href = item.href;
                                a.textContent = item.text;
                                li.appendChild(a);
                            }

                            menuContainer.appendChild(li);
                        });

                        // Add language switcher
                        const languageSwitcher = document.createElement("li");
                        languageSwitcher.className = "nav-item";

                        const switcherLink = document.createElement("a");
                        switcherLink.className = "nav-link";
                        switcherLink.href = "../my-work.html";
                        switcherLink.textContent = "English";
                        switcherLink.addEventListener("click", function () {
                            try {
                                localStorage.setItem("preferredLanguage", "en");
                            } catch (e) {
                                // Silently fail if localStorage unavailable
                            }
                        });

                        languageSwitcher.appendChild(switcherLink);
                        menuContainer.appendChild(languageSwitcher);
                    });
            }

            // Initialize menu
            generateMenu();
        </script>
        <script src="../backToTop.js"></script>
    </body>
</html>
